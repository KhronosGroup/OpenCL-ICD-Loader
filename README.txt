== Building ICD and ICD Test ==

The build system will build ICD Loader library (OpenCL.dll or libOpenCL.so) and
ICD Loader Test binary (icd_loader_test) and some helper libraries for the test.

=== Linux ===

Run "make"

Additional variables can be specified.

|Variable           |Purpose                         |Default value  |
|-------------------|--------------------------------|---------------|
|BUILD_DIR          |Destination of the build process|./build        |
|CMAKE_C_COMPILER   |C compiler                      |gcc            |
|OPENCL_INCLUDE_DIRS|OpenCL Header directory         |./inc          |

Example
    $make OPENCL_INCLUDE_DIRS=../OpenCL-Headers/opencl22

=== Windows ===

Run "build_using_cmake.bat"

== Running ICD Test ==

ICD Test can be run using ctest, which is a companion to cmake. It can also be
run directly by executing icd_loader_test(.exe) executable from the bin folder.

=== Linux ===

1. Add driver stub as an ICD
    echo full/path/to/libOpenCLDriverStub.so > /etc/OpenCL/vendors/test.icd

2. Run test using ctest
    make test

If you have a custom build dir, specify it.
    $make test BUILD_DIR=<build_dir>

=== Windows ===

1. Add driver stub as an ICD by adding appropriate registry value
    Key for 32-bit apps: HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Khronos\OpenCL\Vendors
    Key for 64-bit apps: HKEY_LOCAL_MACHINE\SOFTWARE\Khronos\OpenCL\Vendors

    Add a REG_DWORD value:
        Name: c:/full/path/to/OpenCLDriverStub.dll
        Data: 0

    Note: The build_using_cmake.bat builds ICD test as a 32-bit binary.
    
2. Run test using ctest.exe
    cd build
    ctest.exe

== Cleanup ==

Manually remove the registry key or .icd files added for running the ICD test.

The "build" and "bin" folders are autogenerated by the build so those may be
safely deleted without losing any source code (on Linux "make clobber" will
delete them).

=== Linux ===

If you have a custom build dir, specify it.
    $make clobber BUILD_DIR=<build_dir>

